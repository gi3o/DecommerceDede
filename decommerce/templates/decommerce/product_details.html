{% extends 'decommerce/base.html' %}
{% comment %}
    Shows the details of a product, such the remaining stock, the orders made for the product etc.
{% endcomment %}
{% block title %}{{ product.name }}{% endblock %}
{% block top_title %}{{ product.name }} - Dettagli{% endblock %}
{% block content %}
    {% if error_message %}
            <p class="w3-container w3-text-red">{{ error_message }}</p>
    {% endif %}
    <div class="w3-container w3-row">
        {% if product.stock > 20 %}
            <p class="w3-text-green w3-col">Stock: {{ product.stock }} pezzi</p>
        {% elif product.stock < 20 and product.stock > 0 %}
            <p class="w3-text-orange w3-col">Stock: {{ product.stock }} pezzi</p>
        {% else %}
            <p class="w3-text-red w3-col">Stock terminato</p>
        {% endif %}
        <button class="w3-button w3-third" onclick="expand('addStockDiv')">Aggiungi stock</button>
        <button class="w3-button w3-third" onclick="expand('ordersDiv')">Mostra ordini</button>
    </div>
    
    <div id="addStockDiv" class="w3-row w3-card w3-grayscale w3-container w3-hide">
        <form method="post">
            {% csrf_token %}
            <input type="number" name="stock" required id="id_stock" step="1" class="w3-input">
            <input class="w3-button w3-quarter w3-border-bottom w3-right" type="submit" value="Aggiungi">
    </div>
    
    <div id="ordersDiv" class="w3-container w3-grayscale w3-hide w3-margin-bottom" style="max-height: 300px; overflow-y: auto">
        {% for nation, value in nation_orders.items %}
            {{ nation }} : {{ value }} 
        {% endfor %}
        {% for order in orders %}
            <div class="w3-card w3-row w3-margin-top">
                <div class="w3-container w3-gray">{{ order.date }}</div>
                <div class="w3-col w3-margin-left">Da: {{ order.user }}</div>
                <div class="w3-col w3-margin-left">Indirizzo: {{ order.user.address }}, {{ order.user.nationality }}</div>
                <div class="w3-col w3-margin-left">Numero: {{ order.quantity }}</div>
            </div>
        {% endfor %}
    </div>
    
    
    
{% endblock %}
{% block script %}
    var topMenu = document.getElementById('topMenu');
    var mySidebar = document.getElementById('mySidebar');
    var contentDiv = document.getElementById('contentDiv');
    var hideLargeDiv = document.getElementById('hideLargeDiv');
    var iconParagraph = document.getElementById('iconParagraph');
    mySidebar.style.width = 0;
    contentDiv.style.marginLeft = 0;
    hideLargeDiv.style.display = 'none';
    iconParagraph.style.display = 'none';
    topMenu.style.display = 'none';
    
    function expand(id) {
        var x = document.getElementById(id);
        if (x.className.indexOf("w3-show") == -1) {
            x.className += " w3-show";
        } else {
            x.className = x.className.replace(" w3-show", "");
        }
    }
{% endblock %}
